<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>İçerikUstam AI</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,sans-serif}
body{height:100vh;background:radial-gradient(circle at 20% 20%,#1e3a8a,#020617 60%);color:white;display:flex;justify-content:center;align-items:center}
.app{width:95%;max-width:900px;background:rgba(255,255,255,0.06);backdrop-filter:blur(25px);border-radius:26px;padding:30px}
.logo{font-size:34px;font-weight:800;text-align:center;margin-bottom:25px;background:linear-gradient(90deg,#22c55e,#06b6d4,#a855f7);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.panel{display:none}.active{display:block}
.card{background:rgba(255,255,255,0.05);padding:18px;border-radius:18px;margin-bottom:15px}
input,select,textarea{width:100%;padding:14px;border:none;border-radius:12px;background:rgba(0,0,0,0.5);color:white;margin-top:8px}
button{width:100%;padding:15px;border:none;border-radius:14px;font-weight:700;cursor:pointer;margin-top:12px;background:linear-gradient(90deg,#22c55e,#06b6d4);color:white}
.result{margin-top:18px;padding:18px;border-radius:14px;background:rgba(0,0,0,0.6);min-height:120px;white-space:pre-wrap}
.topbar{display:flex;justify-content:space-between;margin-bottom:15px}
</style>
</head>

<body>

<div class="app">
<div class="logo">İçerikUstam AI</div>

<div id="login" class="panel active">
<div class="card">
Giriş Yap
<input id="email" placeholder="Email">
<input id="pass" type="password" placeholder="Şifre">
<button onclick="login()">Giriş</button>
<button onclick="show('register')">Kayıt Ol</button>
</div>
</div>

<div id="register" class="panel">
<div class="card">
Kayıt Ol
<input id="rEmail" placeholder="Email">
<input id="rPass" type="password" placeholder="Şifre">
<button onclick="register()">Hesap Oluştur</button>
<button onclick="show('login')">Geri</button>
</div>
</div>

<div id="app" class="panel">
<div class="topbar">
<div id="userEmail"></div>
<div id="planBadge">FREE</div>
</div>

<div class="card">
<select id="type">
<option>Instagram Post</option>
<option>TikTok Video Script</option>
<option>YouTube Başlık</option>
<option>Reklam Metni</option>
<option>Ürün Açıklaması</option>
</select>
</div>

<div class="card">
<input id="topic" placeholder="Konu">
<textarea id="detail" placeholder="Detay"></textarea>
<button onclick="generate()">AI İçerik Üret</button>
</div>

<div class="result" id="result"></div>
<button onclick="logout()">Çıkış</button>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
const SUPABASE_URL = "https://leszbkxssduuoytxdjii.supabase.co";
const SUPABASE_KEY = "sb_publishable_mHIjYnEg9y7HVtBPY_Zr0w_6BcbGNTd";
const OPENAI_API_KEY = "BURAYA_OPENAI_KEY";

const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
let currentUser = null;

function show(id){
document.querySelectorAll(".panel").forEach(p=>p.classList.remove("active"));
document.getElementById(id).classList.add("active");
}

async function register(){
const emailVal = document.getElementById("rEmail").value;
const passVal = document.getElementById("rPass").value;

const {error} = await supabase.auth.signUp({
email: emailVal,
password: passVal,
options:{ emailRedirectTo: window.location.origin }
});

if(error) alert(error.message);
else{
alert("Mailine onay linki gönderildi");
show("login");
}
}

async function login(){
const emailVal = document.getElementById("email").value;
const passVal = document.getElementById("pass").value;

const {data,error} = await supabase.auth.signInWithPassword({
email: emailVal,
password: passVal
});

if(error){ alert(error.message); return; }

if(!data.user.email_confirmed_at){
alert("Mail onayı gerekli");
await supabase.auth.signOut();
return;
}

currentUser = data.user;
document.getElementById("userEmail").innerText = currentUser.email;
show("app");
}

async function generate(){
const prompt = ${type.value} için içerik üret: ${topic.value} ${detail.value};

const res = await fetch("https://api.openai.com/v1/chat/completions",{
method:"POST",
headers:{
"Content-Type":"application/json",
"Authorization":"Bearer "+OPENAI_API_KEY
},
body:JSON.stringify({
model:"gpt-4.1-mini",
messages:[{role:"user",content:prompt}]
})
});

const json = await res.json();
document.getElementById("result").innerText =
json.choices?.[0]?.message?.content || "AI cevap vermedi";
}

async function logout(){
await supabase.auth.signOut();
location.reload();
}
</script>

</body>
</html>
